{"version":3,"sources":["../../js/logic.js"],"names":["Detector","webgl","addGetWebGLMessage","OriginalImg","SegmentImg","myFileReader","mouse","THREE","Vector2","raycaster","Raycaster","mousePressed","clickCount","allText","init","animate","readTextFile","originalImgPath","getParameterByName","filename","idDiv","InitCanvas","console","log","segmentedImgPath","name","url","window","location","href","replace","regex","RegExp","results","exec","decodeURIComponent","originalCanvas","document","getElementById","addEventListener","onDocumentMouseDown","onDocumentMouseUp","img2D","Image","twoDeeCanvasImage","ctx2D","clearRect","canvas2D","width","height","drawImage","src","renderer","domElement","toDataURL","event","realClickedCanvasX","offsetX","realClickedCanvasY","offsetY","x","clientX","offsetLeft","clientWidth","y","clientY","offsetTop","clientHeight","setFromCamera","clone","camera","objects","intersectObjects","scene","children","requestAnimationFrame"],"mappings":"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","file":"logic.js","sourcesContent":["if (!Detector.webgl) Detector.addGetWebGLMessage();\r\n\r\n// global variables for this scripts\r\nlet OriginalImg,\r\n    SegmentImg,\r\n    myFileReader;\r\n\r\nvar mouse = new THREE.Vector2();\r\nvar raycaster = new THREE.Raycaster();\r\nvar mousePressed = false;\r\nvar clickCount = 0;\r\nvar allText;\r\n\r\n\r\ninit();\r\nanimate();\r\n\r\n\r\n// initilize the page\r\nfunction init() {\r\n\r\n\r\n    readTextFile(\"columna01-es-latin1.txt\");\r\n\r\n    let originalImgPath = getParameterByName('originalImgPath');\r\n    let filename = originalImgPath || \"models/nrrd/columna02.nrrd\"; // change your nrrd file\r\n    let idDiv = 'original';\r\n    OriginalImg = new InitCanvas(idDiv, filename);\r\n    OriginalImg.init();\r\n    console.log(OriginalImg);\r\n\r\n    let segmentedImgPath = getParameterByName('segmentedImgPath');\r\n\r\n    filename = segmentedImgPath || \"models/nrrd/columnasegmentado02.nrrd\"; // change your nrrd file\r\n    idDiv = 'segment';\r\n    SegmentImg = new InitCanvas(idDiv, filename);\r\n    SegmentImg.init();\r\n}\r\n\r\nfunction getParameterByName(name, url) {\r\n    if (!url) url = window.location.href;\r\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\r\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\r\n        results = regex.exec(url);\r\n    if (!results) return null;\r\n    if (!results[2]) return '';\r\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\r\n}\r\n\r\nlet originalCanvas = document.getElementById('original');\r\noriginalCanvas.addEventListener('mousedown', onDocumentMouseDown, false);\r\noriginalCanvas.addEventListener('mouseup', onDocumentMouseUp, false);\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar img2D = new Image();\r\ntwoDeeCanvasImage.addEventListener(\"load\", function () {\r\n    ctx2D.clearRect(0, 0, canvas2D.width, canvas2D.height);\r\n    ctx2D.drawImage(img2D, 0, 0);\r\n    // from here, get your pixel data\r\n});\r\nimg2D.src = OriginalImg.renderer.domElement.toDataURL(\"img/png\");\r\n\r\n\r\n\r\n\r\n\r\nfunction onDocumentMouseDown(event) {\r\n    mousePressed = true;\r\n\r\n    clickCount++;\r\n\r\n    let realClickedCanvasX = event.offsetX;\r\n    let realClickedCanvasY = event.offsetY;\r\n\r\n    mouse.x = ( ( event.clientX - OriginalImg.renderer.domElement.offsetLeft ) / OriginalImg.renderer.domElement.clientWidth ) * 2 - 1;\r\n    mouse.y = -( ( event.clientY - OriginalImg.renderer.domElement.offsetTop ) / OriginalImg.renderer.domElement.clientHeight ) * 2 + 1\r\n\r\n\r\n\r\n    console.log('Mouse x position is: ', realClickedCanvasX, 'the click number was: ', clickCount);\r\n    console.log('Mouse x position is: ', realClickedCanvasY, 'the click number was: ', clickCount);\r\n\r\n    //console.log('Mouse x position is: ', mouse.x, 'the click number was: ', clickCount);\r\n    //console.log('Mouse Y position is: ', mouse.y);\r\n\r\n    raycaster.setFromCamera(mouse.clone(), OriginalImg.camera);\r\n    var objects = raycaster.intersectObjects(OriginalImg.scene.children);\r\n\r\n    console.log(objects);\r\n}\r\n\r\nfunction onDocumentMouseUp(event) {\r\n    mousePressed = false\r\n}\r\n\r\n\r\nfunction animate() {\r\n\r\n\r\n    requestAnimationFrame(animate);\r\n    OriginalImg.animate();\r\n    SegmentImg.animate();\r\n\r\n\r\n}\r\n\r\n"]}